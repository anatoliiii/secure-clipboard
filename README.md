# Secure Clipboard Server

Secure Clipboard Server — это лёгкий HTTP‑сервис на Go, позволяющий организовать общий буфер обмена между устройствами в одной сети или через интернет. Клиент (настольное приложение, мобильная утилита или браузерный скрипт) решает, использовать ли локальный буфер устройства либо синхронизировать данные с облачным буфером, предоставляемым сервером.

## Возможности

- **Общий буфер между устройствами.** Любой авторизованный клиент может положить текст в общий буфер и забрать его с другого устройства.
- **Разделение локального и облачного буфера.** Клиент может работать только с локальным буфером, а при необходимости переключиться на общий удалённый буфер (например, для быстрой передачи текста между компьютером и смартфоном).
- **HTTP API.** Простые маршруты `/healthz` и `/api/v1/clipboard/text` для проверки статуса сервиса и работы с текстовым буфером.
- **Базовая аутентификация.** Доступ к API защищён HTTP Basic Auth со статическим списком пользователей, задаваемым через переменные окружения.
- **Поддержка CORS.** Возможность ограничить список доверенных Origin для фронтенд‑клиентов.

## Архитектура

- `cmd/server` — точка входа HTTP‑сервера.
- `internal/auth` — авторизация и проверка учетных данных.
- `internal/clipboard` — хранилище содержимого буфера (по умолчанию in-memory).
- `internal/http` — обработчики HTTP‑маршрутов и вспомогательные функции.

## Запуск

Требования: Go 1.21 или новее.

1. Склонируйте репозиторий и перейдите в каталог проекта:
   ```bash
   git clone https://github.com/anatoliiii/secure-clipboard.git
   cd secure-clipboard
   ```
2. Укажите список пользователей в переменной `SECURE_CLIPBOARD_USERS`. Формат — `username=password=Display Name`, несколько записей разделяйте запятыми. Если переменная не задана, автоматически создаётся демонстрационная учётная запись `demo/demo`.
   ```bash
   export SECURE_CLIPBOARD_USERS="alice=secret=Alice Doe,bob=hunter2=Bob Smith"
   ```
3. (Необязательно) Настройте список доверенных Origin для CORS, если планируете подключаться из браузера:
   ```bash
   export SECURE_CLIPBOARD_CORS="https://app.example.com,https://admin.example.com"
   ```
4. Запустите сервер:
   ```bash
   go run ./cmd/server -listen :8080 -cors "$SECURE_CLIPBOARD_CORS"
   ```

Сервер слушает указанный адрес (по умолчанию `:8080`) и обслуживает запросы клиентов.

## Взаимодействие с API

### Проверка состояния
```bash
curl http://localhost:8080/healthz
```

### Чтение общего буфера
```bash
curl -u alice:secret http://localhost:8080/api/v1/clipboard/text
```

Ответ содержит владельца последней записи, текст и время обновления.

### Обновление общего буфера
```bash
curl -u alice:secret \
     -H "Content-Type: application/json" \
     -d '{"content":"Hello from laptop"}' \
     http://localhost:8080/api/v1/clipboard/text
```

For an overview of future milestones and technical decisions, see the [project roadmap](docs/roadmap.md).


- Добавление постоянного хранилища (Redis/SQLite) для доступа к истории буфера.
- Поддержка бинарных данных и файловых вложений.
- Клиентские утилиты для автоматической синхронизации с локальным буфером ОС.

## Лицензия

Проект распространяется по лицензии [GNU Affero General Public License v3.0](LICENSE).

## Контакты

© 2023 MOZGOLIKA  \
Email: mozgolika@vk.com
